let SampleHashes = external_data(hash: string) [h"https://raw.githubusercontent.com/reversinglabs/reversinglabs-siem-rules/master/Malware/QBot/20231218/KQL/qbot-20231218-hashes.txt"];
(union isfuzzy=true
(DeviceFileEvents
| where ActionType == "FileCreated" and SHA256 in (SampleHashes)),
(SysmonParser
| where EventID == 15
| extend MD5 = extract("MD5=(.*?),.*", 1, Hash), SHA256 = extract(".*SHA256=(.*?),.*", 1, Hash)
| where SHA256 in (SampleHashes)))