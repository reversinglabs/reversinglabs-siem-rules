# qbot-20230612

# Notes for this week
- A new infection chain has been identified. See item 6 in the infection chain details below.

# Query overview

- [qbot-20230612-execs.kql](./qbot-20230612-execs.kql) - This query checks the SecurityEvent and Microsoft Defender for Endpoint's DeviceProcessEvents table for QBot related processes. For this week, QBot has been observed running malicious DLL files from the `C:\Users\Public\` folder. 
- [qbot-20230612-network.kql](./qbot-20230612-network.kql) - This query checks the CommonSecurityLog table for matching IP address indicators used by QBot command and control servers.
- [qbot-20230612-files.kql](./qbot-20230612-files.kql) - This query checks the CommonSecurityLog table for matching files hashes seen in various QBot campaigns.

> **Disclaimer**
> The queries listed above that use raw indicators are subject to change and may produce false positives due to the high frequency at which QBot updates their processes. Specifically, the included file hashes have a low probability of detection due to the variations in each campaign. 

# Infection chain details
```
1) email -> <unpack and execute> .zip (.wsf) file -> <download and execute> Qbot .dll file
2) email -> <download and unpack> .zip -> <execute> .js file ->  <download and execute> Qbot .dll file
3) email -> <open> .pdf -> <download> .zip -> <unpack and execute> .zip (.wsf) file -> <download and execute> Qbot .dll file
4) email -> <open> .pdf -> <download and unpack> .zip -> <execute> .js file ->  <download and execute> Qbot .dll file
5) email -> <open> .pdf -> <download and unpack> .zip -> <execute> .js file ->  <download and execute> Qbot .msi file -> <install> Qbot .dll
6) email -> <download and unpack> .zip -> <execute> Qbot.dll
```
