# bumblebee-20230626

> *Want to stay in the loop? Subscribe to be notified for new Microsoft Sentinel content from ReversingLabs: https://www.reversinglabs.com/threat-intel-weekly-newsletter-sign-up*

## Notes for this week
BumbleBee has recently been seen changing the initial dropper from PowerShell to JavaScript, just like IcedID.

# Query overview

- [bumblebee-20230626-files.kql](./bumblebee-20230626-files.kql) - This query checks CommonSecurityLog, DeviceFileEvents, and the SysmonParser function for matching files hashes and file names seen in BumbleBee malware.
- [bumblebee-20230626-execs.kql](./bumblebee-20230626-execs.kql) - This query checks the SecurityEvent and DeviceProcessEvents table for new processes run from the `%appdata%\\Roaming\\Microsoft\\Templates` directory. BumbleBee has been known to create payload files in this location.
- [bumblebee-20230626-network.kql](./bumblebee-20230626-network.kql) - This query checks the CommonSecurityLog table for matching domain name and URL indicators used by BumbleBee command and control servers.
- [NewProcess-RemoteAccessSoftware.kql](./NewRemoteAccessSoftware.kql) - This query identifies new processes in the SecurityEvent and DeviceProcessInfo tables relating to known remote access software utilities. BumbleBee is known is to install AnyDesk and/or DameWare for persistence. To be used with the included [RemoteAccessSoftware.txt](./RemoteAccessSoftware.txt) file as a Microsoft Sentinel Watchlist.

> **Disclaimer**
> The queries listed above that use raw indicators are subject to change and may produce false positives due to the high frequency at which IcedID updates their processes. Specifically, the included file hashes have a low probability of detection due to the variations in each campaign. 

# Infection chain details
```
1) Malspam -> <open and execute>.js (bcd9b7d4ca83e96704e00e378728db06291e8e2b50d68db22efd1f8974d1ca91) -> <download and execute> .dll (EFCBB2624E7590F04BC4185CAE429267D58608F339C2599D302293F9C3F138AA)
```
