# redline-20230731

> *Want to stay in the loop? Subscribe to be notified for new Microsoft Sentinel content from ReversingLabs: https://www.reversinglabs.com/threat-intel-weekly-newsletter-sign-up*

## Notes for this week
The following combinations of malware have been seen recently:
1) most frequently RedLine + Amadey malware
2) RedLine + SmokeLoader
3) SmokeLoader + Vidar + DJVU (Stop Ransomware)
4) Amadey + SmokeLoader + Rhadamanthys

# Query overview
- [redline-20230731-files.kql](./redline-20230731-files.kql) - this query identifies matches in file hash indicators related to recent RedLine samples. Uses [redline-20230731-hashes.txt](./redline-20230731-hashes.txt) as reference.
- [redline-20230731-network.kql](./redline-20230731-network.kql) - this query identifies matches in network indicators related to recent RedLine samples. Uses [redline-20230731-c2domains.txt](./redline-20230731-domains.txt), [redline-20230731-c2ips.txt](./redline-20230731-c2ips.txt), and [redline-20230731-urls.txt](./redline-20230731-urls.txt) as reference.
- [redline-process-msbuild.kql](./redline-process-msbuild.kql) - this query identifies new processes where MsBuild.exe is started from a suspicious parent process. Recent RedLine samples have been shown to use this to harvest credentials.
- [redline-process-DefenderExclusion.kql](./redline-process-defenderexclusion.kql) - this query identifies new processes where an exclusion is added to Windows Defender for a suspicious item. Recent RedLine samples have been shown to perform this action for evasion.

> **Disclaimer**
> The queries listed above that use raw indicators are subject to change and may produce false positives due to the high frequency at which IcedID updates their processes. Specifically, the included file hashes have a low probability of detection due to the variations in each campaign. 

## MITRE ATT&CK
| Tactic         | Technique ID | Technique Name                                |
|----------------|--------------|-----------------------------------------------|
| Initial Access | T1566        | Phishing                                      |
| Execution      | T1204        | User Execution                                |
| Credential Access | T1555      | Credentials from Password Stores             |
|                 | T1539        | Steal Web Session Cookie                      |
|                 | T1552        | Unsecured Credentials                         |
| Collection     | T1113        | Screen Capture                                |
| Discovery      | T1087        | Account Discovery                             |
|                 | T1518        | Software Discovery                            |
|                 | T1057        | Process Discovery                             |
|                 | T1124        | System Time Discovery                         |
|                 | T1007        | System Service Discovery                      |
|                 | T1614        | System Location Discovery                     |
|                 | T1120        | Peripheral Device Discovery                   |
| Command and Control | T1571   | Non-Standard Port                            |
|                 | T1095        | Non-Application Layer Protocol                |
| Exfiltration   | T1041        | Exfiltration Over C2 Channel                  |
