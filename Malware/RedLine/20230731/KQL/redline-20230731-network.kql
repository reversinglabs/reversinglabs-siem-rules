// description: RedLine network indicators for 20230731
let Domains = externaldata(Domain: string) [h"https://raw.githubusercontent.com/reversinglabs/reversinglabs-siem-rules/master/Malware/RedLine/20230731/KQL/redline-20230731-c2domains.txt"];
let IPs = externaldata(Domain: string) [h"https://raw.githubusercontent.com/reversinglabs/reversinglabs-siem-rules/master/Malware/RedLine/20230731/KQL/redline-20230731-c2ips.txt"];
let URLs = externaldata(Domain: string) [h"https://raw.githubusercontent.com/reversinglabs/reversinglabs-siem-rules/master/Malware/RedLine/20230731/KQL/redline-20230731-urls.txt"];
CommonSecurityLog
| where (DestinationHostName in (Domains)) or (RequestURL in (URLs)) or (DestinationIP in (IPs))
| union
(SysmonParser 
| where EventID == 22 
| where QueryName in (Domains))