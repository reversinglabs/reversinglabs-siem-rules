# smokeloader-20230724

> *Want to stay in the loop? Subscribe to be notified for new Microsoft Sentinel content from ReversingLabs: https://www.reversinglabs.com/threat-intel-weekly-newsletter-sign-up*

## Notes for this week

- Recent samples are almost always delivered with RedLine stealer and Amadey bot, and typically ends up deploying Stop/DJVU ransomware

# Query overview
- [smokeloader-20230724-execs.kql](./smokeloader-20230724-execs.kql) - this query identifies new process executions relating to SmokeLoader. 
- [smokeloader-20230724-network.kql](./smokeloader-20230724-network.kql) - this query identifies network indicators of compromise relating to SmokeLoader. See [smokeloader-20230724-c2domains.txt](./smokeloader-20230724-c2domains.txt) for full list of indicators.
- [smokeloader-UnusualScheduledTask.kql](./smokeloader-UnusualScheduledTask.kql) - this query identifies unusual new scheduled tasks created by SmokeLoader. The task program will generally be the same as the parent process.
- [smokeloader-FileCreation.kql](./smokeloader-FileCreation.kql) - this query identifies new files created that may be associated with Smoke Loader. After installation, Smoke Loader will download several plugins.
- [smokeloader-cve201711882.kql](./smokeloader-cve201711882.kql) - this query identifies potential exploitation of CVE-2017-11882, a code execution vulnerability in Microsoft Office's equation editor component. Several recent Smoke Loader samples have been attempting to exploit this vulnerability.

> **Disclaimer**
> The queries listed above that use raw indicators are subject to change and may produce false positives due to the high frequency at which IcedID updates their processes. Specifically, the included file hashes have a low probability of detection due to the variations in each campaign. 

## MITRE ATT&CK

| ID      | Name                                                                  |
|---------|-----------------------------------------------------------------------|
| T1071   | Application Layer Protocol: Web Protocols                         |
| T1547   | Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder |
| T1059   | Command and Scripting Interpreter: Visual Basic                       |
| T1555   | Credentials from Password Stores: Credentials from Web Browsers        |
| T1140   | Deobfuscate/Decode Files or Information                                       |
| T1114   | Email Collection: Local Email Collection                                     |
| T1083   | File and Directory Discovery                                                   |
| T1105   | Ingress Tool Transfer                                                              |
| T1027   | Obfuscated Files or Information                                               |
| T1055   | Process Injection                                                                       |
| T1055.012   | Process Hollowing                                                                       |
| T1053   | Scheduled Task/Job: Scheduled Task                                               |
| T1552   | Unsecured Credentials: Credentials In Files                                 |
| T1497   | Virtualization/Sandbox Evasion: System Checks                                |
