let payloadURLs = external_data(Domain: string) [h"https://raw.githubusercontent.com/reversinglabs/reversinglabs-siem-rules/master/Malware/GuLoader/20240618/KQL/guloader-20240618-payloadUrls.txt"];
CommonSecurityLog
| where RequestURL in (payloadURLs)
| union 
(DeviceNetworkEvents
| where RemoteUrl in (payloadURLs)),
(SysmonParser
| where EventID == 22
| where QueryName in (payloadURLs))
