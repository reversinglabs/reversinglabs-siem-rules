let VBSNames = externaldata(VBSName:string)
[
    @"https://raw.githubusercontent.com/reversinglabs/reversinglabs-siem-rules/guloader-20240618/Malware/GuLoader/20240618/KQL/guloader-20240618-vbs.txt"
];
let FileNames = VBSNames | summarize make_list(VBSName);
SecurityEvent
| where EventID == 4688
| where Process == "wscript.exe" and CommandLine has_any (FileNames)
| union 
(DeviceProcessEvents
| where FileName == "wscript.exe" and ProcessCommandLine has_any (FileNames)
),
(SysmonParser
| where EventID == 1
| where Image contains "wscript.exe" and CommandLine has_any (FileNames))