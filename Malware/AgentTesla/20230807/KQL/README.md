# agenttesla-20230807

> *Want to stay in the loop? Subscribe to be notified for new Microsoft Sentinel content from ReversingLabs: https://www.reversinglabs.com/threat-intel-weekly-newsletter-sign-up*

## Notes for this week
- Recent samples come in all shapes and sizes. AgentTesla can be tricky to detect, but often uses the similar techniques identified in previous query sets.
- AgentTesla continues to use services such as Telegram and Discord for exfiltration - it's highly recommended to monitor or outright block traffic to these sites from systems that shouldn't be talking to these services

# Query overview
- [agenttesla-20230807-network.kql](./agenttesla-20230807-network.kql) - this query identifies recently discovered network indicators of compromise relating to AgentTesla
- [NewProcess-PowerShellSelfCopy.kql](./NewProcess-PowerShellSelfCopy.kql) - this query identifies potential AgentTesla activity where a process copies itself to the Startup folder for persistence.
- [NetworkConnection-SuspiciousRegSvcs.kql](./NetworkConnection-SuspiciousRegSvcs.kql) - this query identifies suspicious network connections created from RegSvcs.exe
- [NewProcess-SuspiciousRegSvcs.kql](./NewProcess-SuspiciousRegSvcs.kql) - this query identifies suspicious execution of RegSvcs.exe


> **Disclaimer**
> The queries listed above that use raw indicators are subject to change and may produce false positives. Specifically, any included file hashes have a low probability of detection due to the variations in each campaign. 
